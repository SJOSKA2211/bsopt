{"version":3,"file":"better-auth_react.js","names":["now","getMethod","fetch","defu$1"],"sources":["../../@better-auth/core/dist/env/env-impl.mjs","../../@better-auth/core/dist/env/color-depth.mjs","../../@better-auth/core/dist/env/logger.mjs","../../@better-auth/core/dist/utils/error-codes.mjs","../../@better-auth/core/dist/utils/string.mjs","../../@better-auth/core/dist/error/codes.mjs","../../@better-auth/core/dist/error/index.mjs","../../better-auth/dist/utils/url.mjs","../../better-auth/dist/client/fetch-plugins.mjs","../../better-auth/dist/client/parser.mjs","../../nanostores/clean-stores/index.js","../../nanostores/atom/index.js","../../nanostores/lifecycle/index.js","../../nanostores/listen-keys/index.js","../../better-auth/dist/client/query.mjs","../../better-auth/dist/client/broadcast-channel.mjs","../../better-auth/dist/client/focus-manager.mjs","../../better-auth/dist/client/online-manager.mjs","../../better-auth/dist/client/session-refresh.mjs","../../better-auth/dist/client/session-atom.mjs","../../defu/dist/defu.mjs","../../@better-fetch/fetch/dist/index.js","../../better-auth/dist/client/config.mjs","../../better-auth/dist/utils/is-atom.mjs","../../better-auth/dist/client/proxy.mjs","../../better-auth/dist/client/react/react-store.mjs","../../better-auth/dist/client/react/index.mjs"],"sourcesContent":["//#region src/env/env-impl.ts\nconst _envShim = Object.create(null);\nconst _getEnv = (useShim) => globalThis.process?.env || globalThis.Deno?.env.toObject() || globalThis.__env__ || (useShim ? _envShim : globalThis);\nconst env = new Proxy(_envShim, {\n\tget(_, prop) {\n\t\treturn _getEnv()[prop] ?? _envShim[prop];\n\t},\n\thas(_, prop) {\n\t\treturn prop in _getEnv() || prop in _envShim;\n\t},\n\tset(_, prop, value) {\n\t\tconst env$1 = _getEnv(true);\n\t\tenv$1[prop] = value;\n\t\treturn true;\n\t},\n\tdeleteProperty(_, prop) {\n\t\tif (!prop) return false;\n\t\tconst env$1 = _getEnv(true);\n\t\tdelete env$1[prop];\n\t\treturn true;\n\t},\n\townKeys() {\n\t\tconst env$1 = _getEnv(true);\n\t\treturn Object.keys(env$1);\n\t}\n});\nfunction toBoolean(val) {\n\treturn val ? val !== \"false\" : false;\n}\nconst nodeENV = typeof process !== \"undefined\" && process.env && process.env.NODE_ENV || \"\";\n/** Detect if `NODE_ENV` environment variable is `production` */\nconst isProduction = nodeENV === \"production\";\n/** Detect if `NODE_ENV` environment variable is `dev` or `development` */\nconst isDevelopment = () => nodeENV === \"dev\" || nodeENV === \"development\";\n/** Detect if `NODE_ENV` environment variable is `test` */\nconst isTest = () => nodeENV === \"test\" || toBoolean(env.TEST);\n/**\n* Get environment variable with fallback\n*/\nfunction getEnvVar(key, fallback) {\n\tif (typeof process !== \"undefined\" && process.env) return process.env[key] ?? fallback;\n\tif (typeof Deno !== \"undefined\") return Deno.env.get(key) ?? fallback;\n\tif (typeof Bun !== \"undefined\") return Bun.env[key] ?? fallback;\n\treturn fallback;\n}\n/**\n* Get boolean environment variable\n*/\nfunction getBooleanEnvVar(key, fallback = true) {\n\tconst value = getEnvVar(key);\n\tif (!value) return fallback;\n\treturn value !== \"0\" && value.toLowerCase() !== \"false\" && value !== \"\";\n}\n/**\n* Common environment variables used in Better Auth\n*/\nconst ENV = Object.freeze({\n\tget BETTER_AUTH_SECRET() {\n\t\treturn getEnvVar(\"BETTER_AUTH_SECRET\");\n\t},\n\tget AUTH_SECRET() {\n\t\treturn getEnvVar(\"AUTH_SECRET\");\n\t},\n\tget BETTER_AUTH_TELEMETRY() {\n\t\treturn getEnvVar(\"BETTER_AUTH_TELEMETRY\");\n\t},\n\tget BETTER_AUTH_TELEMETRY_ID() {\n\t\treturn getEnvVar(\"BETTER_AUTH_TELEMETRY_ID\");\n\t},\n\tget NODE_ENV() {\n\t\treturn getEnvVar(\"NODE_ENV\", \"development\");\n\t},\n\tget PACKAGE_VERSION() {\n\t\treturn getEnvVar(\"PACKAGE_VERSION\", \"0.0.0\");\n\t},\n\tget BETTER_AUTH_TELEMETRY_ENDPOINT() {\n\t\treturn getEnvVar(\"BETTER_AUTH_TELEMETRY_ENDPOINT\", \"\");\n\t}\n});\n\n//#endregion\nexport { ENV, env, getBooleanEnvVar, getEnvVar, isDevelopment, isProduction, isTest, nodeENV };\n//# sourceMappingURL=env-impl.mjs.map","import { env, getEnvVar } from \"./env-impl.mjs\";\n\n//#region src/env/color-depth.ts\nconst COLORS_2 = 1;\nconst COLORS_16 = 4;\nconst COLORS_256 = 8;\nconst COLORS_16m = 24;\nconst TERM_ENVS = {\n\teterm: COLORS_16,\n\tcons25: COLORS_16,\n\tconsole: COLORS_16,\n\tcygwin: COLORS_16,\n\tdtterm: COLORS_16,\n\tgnome: COLORS_16,\n\thurd: COLORS_16,\n\tjfbterm: COLORS_16,\n\tkonsole: COLORS_16,\n\tkterm: COLORS_16,\n\tmlterm: COLORS_16,\n\tmosh: COLORS_16m,\n\tputty: COLORS_16,\n\tst: COLORS_16,\n\t\"rxvt-unicode-24bit\": COLORS_16m,\n\tterminator: COLORS_16m,\n\t\"xterm-kitty\": COLORS_16m\n};\nconst CI_ENVS_MAP = new Map(Object.entries({\n\tAPPVEYOR: COLORS_256,\n\tBUILDKITE: COLORS_256,\n\tCIRCLECI: COLORS_16m,\n\tDRONE: COLORS_256,\n\tGITEA_ACTIONS: COLORS_16m,\n\tGITHUB_ACTIONS: COLORS_16m,\n\tGITLAB_CI: COLORS_256,\n\tTRAVIS: COLORS_256\n}));\nconst TERM_ENVS_REG_EXP = [\n\t/ansi/,\n\t/color/,\n\t/linux/,\n\t/direct/,\n\t/^con[0-9]*x[0-9]/,\n\t/^rxvt/,\n\t/^screen/,\n\t/^xterm/,\n\t/^vt100/,\n\t/^vt220/\n];\nfunction getColorDepth() {\n\tif (getEnvVar(\"FORCE_COLOR\") !== void 0) switch (getEnvVar(\"FORCE_COLOR\")) {\n\t\tcase \"\":\n\t\tcase \"1\":\n\t\tcase \"true\": return COLORS_16;\n\t\tcase \"2\": return COLORS_256;\n\t\tcase \"3\": return COLORS_16m;\n\t\tdefault: return COLORS_2;\n\t}\n\tif (getEnvVar(\"NODE_DISABLE_COLORS\") !== void 0 && getEnvVar(\"NODE_DISABLE_COLORS\") !== \"\" || getEnvVar(\"NO_COLOR\") !== void 0 && getEnvVar(\"NO_COLOR\") !== \"\" || getEnvVar(\"TERM\") === \"dumb\") return COLORS_2;\n\tif (getEnvVar(\"TMUX\")) return COLORS_16m;\n\tif (\"TF_BUILD\" in env && \"AGENT_NAME\" in env) return COLORS_16;\n\tif (\"CI\" in env) {\n\t\tfor (const { 0: envName, 1: colors } of CI_ENVS_MAP) if (envName in env) return colors;\n\t\tif (getEnvVar(\"CI_NAME\") === \"codeship\") return COLORS_256;\n\t\treturn COLORS_2;\n\t}\n\tif (\"TEAMCITY_VERSION\" in env) return /^(9\\.(0*[1-9]\\d*)\\.|\\d{2,}\\.)/.exec(getEnvVar(\"TEAMCITY_VERSION\")) !== null ? COLORS_16 : COLORS_2;\n\tswitch (getEnvVar(\"TERM_PROGRAM\")) {\n\t\tcase \"iTerm.app\":\n\t\t\tif (!getEnvVar(\"TERM_PROGRAM_VERSION\") || /^[0-2]\\./.exec(getEnvVar(\"TERM_PROGRAM_VERSION\")) !== null) return COLORS_256;\n\t\t\treturn COLORS_16m;\n\t\tcase \"HyperTerm\":\n\t\tcase \"MacTerm\": return COLORS_16m;\n\t\tcase \"Apple_Terminal\": return COLORS_256;\n\t}\n\tif (getEnvVar(\"COLORTERM\") === \"truecolor\" || getEnvVar(\"COLORTERM\") === \"24bit\") return COLORS_16m;\n\tif (getEnvVar(\"TERM\")) {\n\t\tif (/truecolor/.exec(getEnvVar(\"TERM\")) !== null) return COLORS_16m;\n\t\tif (/^xterm-256/.exec(getEnvVar(\"TERM\")) !== null) return COLORS_256;\n\t\tconst termEnv = getEnvVar(\"TERM\").toLowerCase();\n\t\tif (TERM_ENVS[termEnv]) return TERM_ENVS[termEnv];\n\t\tif (TERM_ENVS_REG_EXP.some((term) => term.exec(termEnv) !== null)) return COLORS_16;\n\t}\n\tif (getEnvVar(\"COLORTERM\")) return COLORS_16;\n\treturn COLORS_2;\n}\n\n//#endregion\nexport { getColorDepth };\n//# sourceMappingURL=color-depth.mjs.map","import { getColorDepth } from \"./color-depth.mjs\";\n\n//#region src/env/logger.ts\nconst TTY_COLORS = {\n\treset: \"\\x1B[0m\",\n\tbright: \"\\x1B[1m\",\n\tdim: \"\\x1B[2m\",\n\tundim: \"\\x1B[22m\",\n\tunderscore: \"\\x1B[4m\",\n\tblink: \"\\x1B[5m\",\n\treverse: \"\\x1B[7m\",\n\thidden: \"\\x1B[8m\",\n\tfg: {\n\t\tblack: \"\\x1B[30m\",\n\t\tred: \"\\x1B[31m\",\n\t\tgreen: \"\\x1B[32m\",\n\t\tyellow: \"\\x1B[33m\",\n\t\tblue: \"\\x1B[34m\",\n\t\tmagenta: \"\\x1B[35m\",\n\t\tcyan: \"\\x1B[36m\",\n\t\twhite: \"\\x1B[37m\"\n\t},\n\tbg: {\n\t\tblack: \"\\x1B[40m\",\n\t\tred: \"\\x1B[41m\",\n\t\tgreen: \"\\x1B[42m\",\n\t\tyellow: \"\\x1B[43m\",\n\t\tblue: \"\\x1B[44m\",\n\t\tmagenta: \"\\x1B[45m\",\n\t\tcyan: \"\\x1B[46m\",\n\t\twhite: \"\\x1B[47m\"\n\t}\n};\nconst levels = [\n\t\"debug\",\n\t\"info\",\n\t\"success\",\n\t\"warn\",\n\t\"error\"\n];\nfunction shouldPublishLog(currentLogLevel, logLevel) {\n\treturn levels.indexOf(logLevel) >= levels.indexOf(currentLogLevel);\n}\nconst levelColors = {\n\tinfo: TTY_COLORS.fg.blue,\n\tsuccess: TTY_COLORS.fg.green,\n\twarn: TTY_COLORS.fg.yellow,\n\terror: TTY_COLORS.fg.red,\n\tdebug: TTY_COLORS.fg.magenta\n};\nconst formatMessage = (level, message, colorsEnabled) => {\n\tconst timestamp = (/* @__PURE__ */ new Date()).toISOString();\n\tif (colorsEnabled) return `${TTY_COLORS.dim}${timestamp}${TTY_COLORS.reset} ${levelColors[level]}${level.toUpperCase()}${TTY_COLORS.reset} ${TTY_COLORS.bright}[Better Auth]:${TTY_COLORS.reset} ${message}`;\n\treturn `${timestamp} ${level.toUpperCase()} [Better Auth]: ${message}`;\n};\nconst createLogger = (options) => {\n\tconst enabled = options?.disabled !== true;\n\tconst logLevel = options?.level ?? \"warn\";\n\tconst colorsEnabled = options?.disableColors !== void 0 ? !options.disableColors : getColorDepth() !== 1;\n\tconst LogFunc = (level, message, args = []) => {\n\t\tif (!enabled || !shouldPublishLog(logLevel, level)) return;\n\t\tconst formattedMessage = formatMessage(level, message, colorsEnabled);\n\t\tif (!options || typeof options.log !== \"function\") {\n\t\t\tif (level === \"error\") console.error(formattedMessage, ...args);\n\t\t\telse if (level === \"warn\") console.warn(formattedMessage, ...args);\n\t\t\telse console.log(formattedMessage, ...args);\n\t\t\treturn;\n\t\t}\n\t\toptions.log(level === \"success\" ? \"info\" : level, message, ...args);\n\t};\n\treturn {\n\t\t...Object.fromEntries(levels.map((level) => [level, (...[message, ...args]) => LogFunc(level, message, args)])),\n\t\tget level() {\n\t\t\treturn logLevel;\n\t\t}\n\t};\n};\nconst logger = createLogger();\n\n//#endregion\nexport { TTY_COLORS, createLogger, levels, logger, shouldPublishLog };\n//# sourceMappingURL=logger.mjs.map","//#region src/utils/error-codes.ts\nfunction defineErrorCodes(codes) {\n\treturn codes;\n}\n\n//#endregion\nexport { defineErrorCodes };\n//# sourceMappingURL=error-codes.mjs.map","//#region src/utils/string.ts\nfunction capitalizeFirstLetter(str) {\n\treturn str.charAt(0).toUpperCase() + str.slice(1);\n}\n\n//#endregion\nexport { capitalizeFirstLetter };\n//# sourceMappingURL=string.mjs.map","import { defineErrorCodes } from \"../utils/error-codes.mjs\";\nimport \"../utils/index.mjs\";\n\n//#region src/error/codes.ts\nconst BASE_ERROR_CODES = defineErrorCodes({\n\tUSER_NOT_FOUND: \"User not found\",\n\tFAILED_TO_CREATE_USER: \"Failed to create user\",\n\tFAILED_TO_CREATE_SESSION: \"Failed to create session\",\n\tFAILED_TO_UPDATE_USER: \"Failed to update user\",\n\tFAILED_TO_GET_SESSION: \"Failed to get session\",\n\tINVALID_PASSWORD: \"Invalid password\",\n\tINVALID_EMAIL: \"Invalid email\",\n\tINVALID_EMAIL_OR_PASSWORD: \"Invalid email or password\",\n\tSOCIAL_ACCOUNT_ALREADY_LINKED: \"Social account already linked\",\n\tPROVIDER_NOT_FOUND: \"Provider not found\",\n\tINVALID_TOKEN: \"Invalid token\",\n\tID_TOKEN_NOT_SUPPORTED: \"id_token not supported\",\n\tFAILED_TO_GET_USER_INFO: \"Failed to get user info\",\n\tUSER_EMAIL_NOT_FOUND: \"User email not found\",\n\tEMAIL_NOT_VERIFIED: \"Email not verified\",\n\tPASSWORD_TOO_SHORT: \"Password too short\",\n\tPASSWORD_TOO_LONG: \"Password too long\",\n\tUSER_ALREADY_EXISTS: \"User already exists.\",\n\tUSER_ALREADY_EXISTS_USE_ANOTHER_EMAIL: \"User already exists. Use another email.\",\n\tEMAIL_CAN_NOT_BE_UPDATED: \"Email can not be updated\",\n\tCREDENTIAL_ACCOUNT_NOT_FOUND: \"Credential account not found\",\n\tSESSION_EXPIRED: \"Session expired. Re-authenticate to perform this action.\",\n\tFAILED_TO_UNLINK_LAST_ACCOUNT: \"You can't unlink your last account\",\n\tACCOUNT_NOT_FOUND: \"Account not found\",\n\tUSER_ALREADY_HAS_PASSWORD: \"User already has a password. Provide that to delete the account.\",\n\tCROSS_SITE_NAVIGATION_LOGIN_BLOCKED: \"Cross-site navigation login blocked. This request appears to be a CSRF attack.\",\n\tVERIFICATION_EMAIL_NOT_ENABLED: \"Verification email isn't enabled\",\n\tEMAIL_ALREADY_VERIFIED: \"Email is already verified\",\n\tEMAIL_MISMATCH: \"Email mismatch\",\n\tSESSION_NOT_FRESH: \"Session is not fresh\",\n\tLINKED_ACCOUNT_ALREADY_EXISTS: \"Linked account already exists\",\n\tINVALID_ORIGIN: \"Invalid origin\",\n\tINVALID_CALLBACK_URL: \"Invalid callbackURL\",\n\tINVALID_REDIRECT_URL: \"Invalid redirectURL\",\n\tINVALID_ERROR_CALLBACK_URL: \"Invalid errorCallbackURL\",\n\tINVALID_NEW_USER_CALLBACK_URL: \"Invalid newUserCallbackURL\",\n\tMISSING_OR_NULL_ORIGIN: \"Missing or null Origin\",\n\tCALLBACK_URL_REQUIRED: \"callbackURL is required\",\n\tFAILED_TO_CREATE_VERIFICATION: \"Unable to create verification\",\n\tFIELD_NOT_ALLOWED: \"Field not allowed to be set\",\n\tASYNC_VALIDATION_NOT_SUPPORTED: \"Async validation is not supported\",\n\tVALIDATION_ERROR: \"Validation Error\",\n\tMISSING_FIELD: \"Field is required\"\n});\n\n//#endregion\nexport { BASE_ERROR_CODES };\n//# sourceMappingURL=codes.mjs.map","import { BASE_ERROR_CODES } from \"./codes.mjs\";\n\n//#region src/error/index.ts\nvar BetterAuthError = class extends Error {\n\tconstructor(message, options) {\n\t\tsuper(message, options);\n\t\tthis.name = \"BetterAuthError\";\n\t\tthis.message = message;\n\t\tthis.stack = \"\";\n\t}\n};\n\n//#endregion\nexport { BASE_ERROR_CODES, BetterAuthError };\n//# sourceMappingURL=index.mjs.map","import { env } from \"@better-auth/core/env\";\nimport { BetterAuthError } from \"@better-auth/core/error\";\n\n//#region src/utils/url.ts\nfunction checkHasPath(url) {\n\ttry {\n\t\treturn (new URL(url).pathname.replace(/\\/+$/, \"\") || \"/\") !== \"/\";\n\t} catch {\n\t\tthrow new BetterAuthError(`Invalid base URL: ${url}. Please provide a valid base URL.`);\n\t}\n}\nfunction assertHasProtocol(url) {\n\ttry {\n\t\tconst parsedUrl = new URL(url);\n\t\tif (parsedUrl.protocol !== \"http:\" && parsedUrl.protocol !== \"https:\") throw new BetterAuthError(`Invalid base URL: ${url}. URL must include 'http://' or 'https://'`);\n\t} catch (error) {\n\t\tif (error instanceof BetterAuthError) throw error;\n\t\tthrow new BetterAuthError(`Invalid base URL: ${url}. Please provide a valid base URL.`, { cause: error });\n\t}\n}\nfunction withPath(url, path = \"/api/auth\") {\n\tassertHasProtocol(url);\n\tif (checkHasPath(url)) return url;\n\tconst trimmedUrl = url.replace(/\\/+$/, \"\");\n\tif (!path || path === \"/\") return trimmedUrl;\n\tpath = path.startsWith(\"/\") ? path : `/${path}`;\n\treturn `${trimmedUrl}${path}`;\n}\nfunction validateProxyHeader(header, type) {\n\tif (!header || header.trim() === \"\") return false;\n\tif (type === \"proto\") return header === \"http\" || header === \"https\";\n\tif (type === \"host\") {\n\t\tif ([\n\t\t\t/\\.\\./,\n\t\t\t/\\0/,\n\t\t\t/[\\s]/,\n\t\t\t/^[.]/,\n\t\t\t/[<>'\"]/,\n\t\t\t/javascript:/i,\n\t\t\t/file:/i,\n\t\t\t/data:/i\n\t\t].some((pattern) => pattern.test(header))) return false;\n\t\treturn /^[a-zA-Z0-9]([a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(\\.[a-zA-Z0-9]([a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*(:[0-9]{1,5})?$/.test(header) || /^(\\d{1,3}\\.){3}\\d{1,3}(:[0-9]{1,5})?$/.test(header) || /^\\[[0-9a-fA-F:]+\\](:[0-9]{1,5})?$/.test(header) || /^localhost(:[0-9]{1,5})?$/i.test(header);\n\t}\n\treturn false;\n}\nfunction getBaseURL(url, path, request, loadEnv, trustedProxyHeaders) {\n\tif (url) return withPath(url, path);\n\tif (loadEnv !== false) {\n\t\tconst fromEnv = env.BETTER_AUTH_URL || env.NEXT_PUBLIC_BETTER_AUTH_URL || env.PUBLIC_BETTER_AUTH_URL || env.NUXT_PUBLIC_BETTER_AUTH_URL || env.NUXT_PUBLIC_AUTH_URL || (env.BASE_URL !== \"/\" ? env.BASE_URL : void 0);\n\t\tif (fromEnv) return withPath(fromEnv, path);\n\t}\n\tconst fromRequest = request?.headers.get(\"x-forwarded-host\");\n\tconst fromRequestProto = request?.headers.get(\"x-forwarded-proto\");\n\tif (fromRequest && fromRequestProto && trustedProxyHeaders) {\n\t\tif (validateProxyHeader(fromRequestProto, \"proto\") && validateProxyHeader(fromRequest, \"host\")) try {\n\t\t\treturn withPath(`${fromRequestProto}://${fromRequest}`, path);\n\t\t} catch (_error) {}\n\t}\n\tif (request) {\n\t\tconst url$1 = getOrigin(request.url);\n\t\tif (!url$1) throw new BetterAuthError(\"Could not get origin from request. Please provide a valid base URL.\");\n\t\treturn withPath(url$1, path);\n\t}\n\tif (typeof window !== \"undefined\" && window.location) return withPath(window.location.origin, path);\n}\nfunction getOrigin(url) {\n\ttry {\n\t\tconst parsedUrl = new URL(url);\n\t\treturn parsedUrl.origin === \"null\" ? null : parsedUrl.origin;\n\t} catch {\n\t\treturn null;\n\t}\n}\nfunction getProtocol(url) {\n\ttry {\n\t\treturn new URL(url).protocol;\n\t} catch {\n\t\treturn null;\n\t}\n}\nfunction getHost(url) {\n\ttry {\n\t\treturn new URL(url).host;\n\t} catch {\n\t\treturn null;\n\t}\n}\n\n//#endregion\nexport { getBaseURL, getHost, getOrigin, getProtocol };\n//# sourceMappingURL=url.mjs.map","//#region src/client/fetch-plugins.ts\nconst redirectPlugin = {\n\tid: \"redirect\",\n\tname: \"Redirect\",\n\thooks: { onSuccess(context) {\n\t\tif (context.data?.url && context.data?.redirect) {\n\t\t\tif (typeof window !== \"undefined\" && window.location) {\n\t\t\t\tif (window.location) try {\n\t\t\t\t\twindow.location.href = context.data.url;\n\t\t\t\t} catch {}\n\t\t\t}\n\t\t}\n\t} }\n};\n\n//#endregion\nexport { redirectPlugin };\n//# sourceMappingURL=fetch-plugins.mjs.map","//#region src/client/parser.ts\nconst PROTO_POLLUTION_PATTERNS = {\n\tproto: /\"(?:_|\\\\u0{2}5[Ff]){2}(?:p|\\\\u0{2}70)(?:r|\\\\u0{2}72)(?:o|\\\\u0{2}6[Ff])(?:t|\\\\u0{2}74)(?:o|\\\\u0{2}6[Ff])(?:_|\\\\u0{2}5[Ff]){2}\"\\s*:/,\n\tconstructor: /\"(?:c|\\\\u0063)(?:o|\\\\u006[Ff])(?:n|\\\\u006[Ee])(?:s|\\\\u0073)(?:t|\\\\u0074)(?:r|\\\\u0072)(?:u|\\\\u0075)(?:c|\\\\u0063)(?:t|\\\\u0074)(?:o|\\\\u006[Ff])(?:r|\\\\u0072)\"\\s*:/,\n\tprotoShort: /\"__proto__\"\\s*:/,\n\tconstructorShort: /\"constructor\"\\s*:/\n};\nconst JSON_SIGNATURE = /^\\s*[\"[{]|^\\s*-?\\d{1,16}(\\.\\d{1,17})?([Ee][+-]?\\d+)?\\s*$/;\nconst SPECIAL_VALUES = {\n\ttrue: true,\n\tfalse: false,\n\tnull: null,\n\tundefined: void 0,\n\tnan: NaN,\n\tinfinity: Number.POSITIVE_INFINITY,\n\t\"-infinity\": Number.NEGATIVE_INFINITY\n};\nconst ISO_DATE_REGEX = /^(\\d{4})-(\\d{2})-(\\d{2})T(\\d{2}):(\\d{2}):(\\d{2})(?:\\.(\\d{1,7}))?(?:Z|([+-])(\\d{2}):(\\d{2}))$/;\nfunction isValidDate(date) {\n\treturn date instanceof Date && !isNaN(date.getTime());\n}\nfunction parseISODate(value) {\n\tconst match = ISO_DATE_REGEX.exec(value);\n\tif (!match) return null;\n\tconst [, year, month, day, hour, minute, second, ms, offsetSign, offsetHour, offsetMinute] = match;\n\tconst date = new Date(Date.UTC(parseInt(year, 10), parseInt(month, 10) - 1, parseInt(day, 10), parseInt(hour, 10), parseInt(minute, 10), parseInt(second, 10), ms ? parseInt(ms.padEnd(3, \"0\"), 10) : 0));\n\tif (offsetSign) {\n\t\tconst offset = (parseInt(offsetHour, 10) * 60 + parseInt(offsetMinute, 10)) * (offsetSign === \"+\" ? -1 : 1);\n\t\tdate.setUTCMinutes(date.getUTCMinutes() + offset);\n\t}\n\treturn isValidDate(date) ? date : null;\n}\nfunction betterJSONParse(value, options = {}) {\n\tconst { strict = false, warnings = false, reviver, parseDates = true } = options;\n\tif (typeof value !== \"string\") return value;\n\tconst trimmed = value.trim();\n\tif (trimmed.length > 0 && trimmed[0] === \"\\\"\" && trimmed.endsWith(\"\\\"\") && !trimmed.slice(1, -1).includes(\"\\\"\")) return trimmed.slice(1, -1);\n\tconst lowerValue = trimmed.toLowerCase();\n\tif (lowerValue.length <= 9 && lowerValue in SPECIAL_VALUES) return SPECIAL_VALUES[lowerValue];\n\tif (!JSON_SIGNATURE.test(trimmed)) {\n\t\tif (strict) throw new SyntaxError(\"[better-json] Invalid JSON\");\n\t\treturn value;\n\t}\n\tif (Object.entries(PROTO_POLLUTION_PATTERNS).some(([key, pattern]) => {\n\t\tconst matches = pattern.test(trimmed);\n\t\tif (matches && warnings) console.warn(`[better-json] Detected potential prototype pollution attempt using ${key} pattern`);\n\t\treturn matches;\n\t}) && strict) throw new Error(\"[better-json] Potential prototype pollution attempt detected\");\n\ttry {\n\t\tconst secureReviver = (key, value$1) => {\n\t\t\tif (key === \"__proto__\" || key === \"constructor\" && value$1 && typeof value$1 === \"object\" && \"prototype\" in value$1) {\n\t\t\t\tif (warnings) console.warn(`[better-json] Dropping \"${key}\" key to prevent prototype pollution`);\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tif (parseDates && typeof value$1 === \"string\") {\n\t\t\t\tconst date = parseISODate(value$1);\n\t\t\t\tif (date) return date;\n\t\t\t}\n\t\t\treturn reviver ? reviver(key, value$1) : value$1;\n\t\t};\n\t\treturn JSON.parse(trimmed, secureReviver);\n\t} catch (error) {\n\t\tif (strict) throw error;\n\t\treturn value;\n\t}\n}\nfunction parseJSON(value, options = { strict: true }) {\n\treturn betterJSONParse(value, options);\n}\n\n//#endregion\nexport { parseJSON };\n//# sourceMappingURL=parser.mjs.map","import { cleanTasks } from '../task/index.js'\n\nexport let clean = Symbol('clean')\n\nexport let cleanStores = (...stores) => {\n  if (process.env.NODE_ENV === 'production') {\n    throw new Error(\n      'cleanStores() can be used only during development or tests'\n    )\n  }\n  cleanTasks()\n  for (let $store of stores) {\n    if ($store) {\n      if ($store.mocked) delete $store.mocked\n      if ($store[clean]) $store[clean]()\n    }\n  }\n}\n","import { clean } from '../clean-stores/index.js'\n\nlet listenerQueue = []\nlet lqIndex = 0\nconst QUEUE_ITEMS_PER_LISTENER = 4\nexport let epoch = 0\n\n/* @__NO_SIDE_EFFECTS__ */\nexport const atom = initialValue => {\n  let listeners = []\n  let $atom = {\n    get() {\n      if (!$atom.lc) {\n        $atom.listen(() => {})()\n      }\n      return $atom.value\n    },\n    lc: 0,\n    listen(listener) {\n      $atom.lc = listeners.push(listener)\n\n      return () => {\n        for (\n          let i = lqIndex + QUEUE_ITEMS_PER_LISTENER;\n          i < listenerQueue.length;\n\n        ) {\n          if (listenerQueue[i] === listener) {\n            listenerQueue.splice(i, QUEUE_ITEMS_PER_LISTENER)\n          } else {\n            i += QUEUE_ITEMS_PER_LISTENER\n          }\n        }\n\n        let index = listeners.indexOf(listener)\n        if (~index) {\n          listeners.splice(index, 1)\n          if (!--$atom.lc) $atom.off()\n        }\n      }\n    },\n    notify(oldValue, changedKey) {\n      epoch++\n      let runListenerQueue = !listenerQueue.length\n      for (let listener of listeners) {\n        listenerQueue.push(listener, $atom.value, oldValue, changedKey)\n      }\n\n      if (runListenerQueue) {\n        for (\n          lqIndex = 0;\n          lqIndex < listenerQueue.length;\n          lqIndex += QUEUE_ITEMS_PER_LISTENER\n        ) {\n          listenerQueue[lqIndex](\n            listenerQueue[lqIndex + 1],\n            listenerQueue[lqIndex + 2],\n            listenerQueue[lqIndex + 3]\n          )\n        }\n        listenerQueue.length = 0\n      }\n    },\n    /* It will be called on last listener unsubscribing.\n       We will redefine it in onMount and onStop. */\n    off() {},\n    set(newValue) {\n      let oldValue = $atom.value\n      if (oldValue !== newValue) {\n        $atom.value = newValue\n        $atom.notify(oldValue)\n      }\n    },\n    subscribe(listener) {\n      let unbind = $atom.listen(listener)\n      listener($atom.value)\n      return unbind\n    },\n    value: initialValue\n  }\n\n  if (process.env.NODE_ENV !== 'production') {\n    $atom[clean] = () => {\n      listeners = []\n      $atom.lc = 0\n      $atom.off()\n    }\n  }\n\n  return $atom\n}\n\nexport const readonlyType = store => store\n","import { clean } from '../clean-stores/index.js'\n\nconst START = 0\nconst STOP = 1\nconst SET = 2\nconst NOTIFY = 3\nconst MOUNT = 5\nconst UNMOUNT = 6\nconst REVERT_MUTATION = 10\n\nexport let on = (object, listener, eventKey, mutateStore) => {\n  object.events = object.events || {}\n  if (!object.events[eventKey + REVERT_MUTATION]) {\n    object.events[eventKey + REVERT_MUTATION] = mutateStore(eventProps => {\n      // eslint-disable-next-line no-sequences\n      object.events[eventKey].reduceRight((event, l) => (l(event), event), {\n        shared: {},\n        ...eventProps\n      })\n    })\n  }\n  object.events[eventKey] = object.events[eventKey] || []\n  object.events[eventKey].push(listener)\n  return () => {\n    let currentListeners = object.events[eventKey]\n    let index = currentListeners.indexOf(listener)\n    currentListeners.splice(index, 1)\n    if (!currentListeners.length) {\n      delete object.events[eventKey]\n      object.events[eventKey + REVERT_MUTATION]()\n      delete object.events[eventKey + REVERT_MUTATION]\n    }\n  }\n}\n\nexport let onStart = ($store, listener) =>\n  on($store, listener, START, runListeners => {\n    let originListen = $store.listen\n    $store.listen = arg => {\n      if (!$store.lc && !$store.starting) {\n        $store.starting = true\n        runListeners()\n        delete $store.starting\n      }\n      return originListen(arg)\n    }\n    return () => {\n      $store.listen = originListen\n    }\n  })\n\nexport let onStop = ($store, listener) =>\n  on($store, listener, STOP, runListeners => {\n    let originOff = $store.off\n    $store.off = () => {\n      runListeners()\n      originOff()\n    }\n    return () => {\n      $store.off = originOff\n    }\n  })\n\nexport let onSet = ($store, listener) =>\n  on($store, listener, SET, runListeners => {\n    let originSet = $store.set\n    let originSetKey = $store.setKey\n    if ($store.setKey) {\n      $store.setKey = (changed, changedValue) => {\n        let isAborted\n        let abort = () => {\n          isAborted = true\n        }\n\n        runListeners({\n          abort,\n          changed,\n          newValue: { ...$store.value, [changed]: changedValue }\n        })\n        if (!isAborted) return originSetKey(changed, changedValue)\n      }\n    }\n    $store.set = newValue => {\n      let isAborted\n      let abort = () => {\n        isAborted = true\n      }\n\n      runListeners({ abort, newValue })\n      if (!isAborted) return originSet(newValue)\n    }\n    return () => {\n      $store.set = originSet\n      $store.setKey = originSetKey\n    }\n  })\n\nexport let onNotify = ($store, listener) =>\n  on($store, listener, NOTIFY, runListeners => {\n    let originNotify = $store.notify\n    $store.notify = (oldValue, changed) => {\n      let isAborted\n      let abort = () => {\n        isAborted = true\n      }\n\n      runListeners({ abort, changed, oldValue })\n      if (!isAborted) return originNotify(oldValue, changed)\n    }\n    return () => {\n      $store.notify = originNotify\n    }\n  })\n\nexport let STORE_UNMOUNT_DELAY = 1000\n\nexport let onMount = ($store, initialize) => {\n  let listener = payload => {\n    let destroy = initialize(payload)\n    if (destroy) $store.events[UNMOUNT].push(destroy)\n  }\n  return on($store, listener, MOUNT, runListeners => {\n    let originListen = $store.listen\n    $store.listen = (...args) => {\n      if (!$store.lc && !$store.active) {\n        $store.active = true\n        runListeners()\n      }\n      return originListen(...args)\n    }\n\n    let originOff = $store.off\n    $store.events[UNMOUNT] = []\n    $store.off = () => {\n      originOff()\n      setTimeout(() => {\n        if ($store.active && !$store.lc) {\n          $store.active = false\n          for (let destroy of $store.events[UNMOUNT]) destroy()\n          $store.events[UNMOUNT] = []\n        }\n      }, STORE_UNMOUNT_DELAY)\n    }\n\n    if (process.env.NODE_ENV !== 'production') {\n      let originClean = $store[clean]\n      $store[clean] = () => {\n        for (let destroy of $store.events[UNMOUNT]) destroy()\n        $store.events[UNMOUNT] = []\n        $store.active = false\n        originClean()\n      }\n    }\n\n    return () => {\n      $store.listen = originListen\n      $store.off = originOff\n    }\n  })\n}\n","export function listenKeys($store, keys, listener) {\n  let keysSet = new Set(keys).add(undefined)\n  return $store.listen((value, oldValue, changed) => {\n    if (keysSet.has(changed)) {\n      listener(value, oldValue, changed)\n    }\n  })\n}\n\nexport function subscribeKeys($store, keys, listener) {\n  let unbind = listenKeys($store, keys, listener)\n  listener($store.value)\n  return unbind\n}\n","import { atom, onMount } from \"nanostores\";\n\n//#region src/client/query.ts\nconst isServer = () => typeof window === \"undefined\";\nconst useAuthQuery = (initializedAtom, path, $fetch, options) => {\n\tconst value = atom({\n\t\tdata: null,\n\t\terror: null,\n\t\tisPending: true,\n\t\tisRefetching: false,\n\t\trefetch: (queryParams) => fn(queryParams)\n\t});\n\tconst fn = async (queryParams) => {\n\t\treturn new Promise((resolve) => {\n\t\t\tconst opts = typeof options === \"function\" ? options({\n\t\t\t\tdata: value.get().data,\n\t\t\t\terror: value.get().error,\n\t\t\t\tisPending: value.get().isPending\n\t\t\t}) : options;\n\t\t\t$fetch(path, {\n\t\t\t\t...opts,\n\t\t\t\tquery: {\n\t\t\t\t\t...opts?.query,\n\t\t\t\t\t...queryParams?.query\n\t\t\t\t},\n\t\t\t\tasync onSuccess(context) {\n\t\t\t\t\tvalue.set({\n\t\t\t\t\t\tdata: context.data,\n\t\t\t\t\t\terror: null,\n\t\t\t\t\t\tisPending: false,\n\t\t\t\t\t\tisRefetching: false,\n\t\t\t\t\t\trefetch: value.value.refetch\n\t\t\t\t\t});\n\t\t\t\t\tawait opts?.onSuccess?.(context);\n\t\t\t\t},\n\t\t\t\tasync onError(context) {\n\t\t\t\t\tconst { request } = context;\n\t\t\t\t\tconst retryAttempts = typeof request.retry === \"number\" ? request.retry : request.retry?.attempts;\n\t\t\t\t\tconst retryAttempt = request.retryAttempt || 0;\n\t\t\t\t\tif (retryAttempts && retryAttempt < retryAttempts) return;\n\t\t\t\t\tvalue.set({\n\t\t\t\t\t\terror: context.error,\n\t\t\t\t\t\tdata: null,\n\t\t\t\t\t\tisPending: false,\n\t\t\t\t\t\tisRefetching: false,\n\t\t\t\t\t\trefetch: value.value.refetch\n\t\t\t\t\t});\n\t\t\t\t\tawait opts?.onError?.(context);\n\t\t\t\t},\n\t\t\t\tasync onRequest(context) {\n\t\t\t\t\tconst currentValue = value.get();\n\t\t\t\t\tvalue.set({\n\t\t\t\t\t\tisPending: currentValue.data === null,\n\t\t\t\t\t\tdata: currentValue.data,\n\t\t\t\t\t\terror: null,\n\t\t\t\t\t\tisRefetching: true,\n\t\t\t\t\t\trefetch: value.value.refetch\n\t\t\t\t\t});\n\t\t\t\t\tawait opts?.onRequest?.(context);\n\t\t\t\t}\n\t\t\t}).catch((error) => {\n\t\t\t\tvalue.set({\n\t\t\t\t\terror,\n\t\t\t\t\tdata: null,\n\t\t\t\t\tisPending: false,\n\t\t\t\t\tisRefetching: false,\n\t\t\t\t\trefetch: value.value.refetch\n\t\t\t\t});\n\t\t\t}).finally(() => {\n\t\t\t\tresolve(void 0);\n\t\t\t});\n\t\t});\n\t};\n\tinitializedAtom = Array.isArray(initializedAtom) ? initializedAtom : [initializedAtom];\n\tlet isMounted = false;\n\tfor (const initAtom of initializedAtom) initAtom.subscribe(async () => {\n\t\tif (isServer()) return;\n\t\tif (isMounted) await fn();\n\t\telse onMount(value, () => {\n\t\t\tconst timeoutId = setTimeout(async () => {\n\t\t\t\tif (!isMounted) {\n\t\t\t\t\tawait fn();\n\t\t\t\t\tisMounted = true;\n\t\t\t\t}\n\t\t\t}, 0);\n\t\t\treturn () => {\n\t\t\t\tvalue.off();\n\t\t\t\tinitAtom.off();\n\t\t\t\tclearTimeout(timeoutId);\n\t\t\t};\n\t\t});\n\t});\n\treturn value;\n};\n\n//#endregion\nexport { useAuthQuery };\n//# sourceMappingURL=query.mjs.map","//#region src/client/broadcast-channel.ts\nconst kBroadcastChannel = Symbol.for(\"better-auth:broadcast-channel\");\nconst now = () => Math.floor(Date.now() / 1e3);\nvar WindowBroadcastChannel = class {\n\tlisteners = /* @__PURE__ */ new Set();\n\tname;\n\tconstructor(name = \"better-auth.message\") {\n\t\tthis.name = name;\n\t}\n\tsubscribe(listener) {\n\t\tthis.listeners.add(listener);\n\t\treturn () => {\n\t\t\tthis.listeners.delete(listener);\n\t\t};\n\t}\n\tpost(message) {\n\t\tif (typeof window === \"undefined\") return;\n\t\ttry {\n\t\t\tlocalStorage.setItem(this.name, JSON.stringify({\n\t\t\t\t...message,\n\t\t\t\ttimestamp: now()\n\t\t\t}));\n\t\t} catch {}\n\t}\n\tsetup() {\n\t\tif (typeof window === \"undefined\" || typeof window.addEventListener === \"undefined\") return () => {};\n\t\tconst handler = (event) => {\n\t\t\tif (event.key !== this.name) return;\n\t\t\tconst message = JSON.parse(event.newValue ?? \"{}\");\n\t\t\tif (message?.event !== \"session\" || !message?.data) return;\n\t\t\tthis.listeners.forEach((listener) => listener(message));\n\t\t};\n\t\twindow.addEventListener(\"storage\", handler);\n\t\treturn () => {\n\t\t\twindow.removeEventListener(\"storage\", handler);\n\t\t};\n\t}\n};\nfunction getGlobalBroadcastChannel(name = \"better-auth.message\") {\n\tif (!globalThis[kBroadcastChannel]) globalThis[kBroadcastChannel] = new WindowBroadcastChannel(name);\n\treturn globalThis[kBroadcastChannel];\n}\n\n//#endregion\nexport { getGlobalBroadcastChannel, kBroadcastChannel };\n//# sourceMappingURL=broadcast-channel.mjs.map","//#region src/client/focus-manager.ts\nconst kFocusManager = Symbol.for(\"better-auth:focus-manager\");\nvar WindowFocusManager = class {\n\tlisteners = /* @__PURE__ */ new Set();\n\tsubscribe(listener) {\n\t\tthis.listeners.add(listener);\n\t\treturn () => {\n\t\t\tthis.listeners.delete(listener);\n\t\t};\n\t}\n\tsetFocused(focused) {\n\t\tthis.listeners.forEach((listener) => listener(focused));\n\t}\n\tsetup() {\n\t\tif (typeof window === \"undefined\" || typeof document === \"undefined\" || typeof window.addEventListener === \"undefined\") return () => {};\n\t\tconst visibilityHandler = () => {\n\t\t\tif (document.visibilityState === \"visible\") this.setFocused(true);\n\t\t};\n\t\tdocument.addEventListener(\"visibilitychange\", visibilityHandler, false);\n\t\treturn () => {\n\t\t\tdocument.removeEventListener(\"visibilitychange\", visibilityHandler, false);\n\t\t};\n\t}\n};\nfunction getGlobalFocusManager() {\n\tif (!globalThis[kFocusManager]) globalThis[kFocusManager] = new WindowFocusManager();\n\treturn globalThis[kFocusManager];\n}\n\n//#endregion\nexport { getGlobalFocusManager, kFocusManager };\n//# sourceMappingURL=focus-manager.mjs.map","//#region src/client/online-manager.ts\nconst kOnlineManager = Symbol.for(\"better-auth:online-manager\");\nvar WindowOnlineManager = class {\n\tlisteners = /* @__PURE__ */ new Set();\n\tisOnline = typeof navigator !== \"undefined\" ? navigator.onLine : true;\n\tsubscribe(listener) {\n\t\tthis.listeners.add(listener);\n\t\treturn () => {\n\t\t\tthis.listeners.delete(listener);\n\t\t};\n\t}\n\tsetOnline(online) {\n\t\tthis.isOnline = online;\n\t\tthis.listeners.forEach((listener) => listener(online));\n\t}\n\tsetup() {\n\t\tif (typeof window === \"undefined\" || typeof window.addEventListener === \"undefined\") return () => {};\n\t\tconst onOnline = () => this.setOnline(true);\n\t\tconst onOffline = () => this.setOnline(false);\n\t\twindow.addEventListener(\"online\", onOnline, false);\n\t\twindow.addEventListener(\"offline\", onOffline, false);\n\t\treturn () => {\n\t\t\twindow.removeEventListener(\"online\", onOnline, false);\n\t\t\twindow.removeEventListener(\"offline\", onOffline, false);\n\t\t};\n\t}\n};\nfunction getGlobalOnlineManager() {\n\tif (!globalThis[kOnlineManager]) globalThis[kOnlineManager] = new WindowOnlineManager();\n\treturn globalThis[kOnlineManager];\n}\n\n//#endregion\nexport { getGlobalOnlineManager, kOnlineManager };\n//# sourceMappingURL=online-manager.mjs.map","import { getGlobalBroadcastChannel } from \"./broadcast-channel.mjs\";\nimport { getGlobalFocusManager } from \"./focus-manager.mjs\";\nimport { getGlobalOnlineManager } from \"./online-manager.mjs\";\n\n//#region src/client/session-refresh.ts\nconst now = () => Math.floor(Date.now() / 1e3);\n/**\n* Rate limit: don't refetch on focus if a session request was made within this many seconds\n*/\nconst FOCUS_REFETCH_RATE_LIMIT_SECONDS = 5;\nfunction createSessionRefreshManager(opts) {\n\tconst { sessionAtom, sessionSignal, $fetch, options = {} } = opts;\n\tconst refetchInterval = options.sessionOptions?.refetchInterval ?? 0;\n\tconst refetchOnWindowFocus = options.sessionOptions?.refetchOnWindowFocus ?? true;\n\tconst refetchWhenOffline = options.sessionOptions?.refetchWhenOffline ?? false;\n\tconst state = {\n\t\tlastSync: 0,\n\t\tlastSessionRequest: 0,\n\t\tcachedSession: void 0\n\t};\n\tconst shouldRefetch = () => {\n\t\treturn refetchWhenOffline || getGlobalOnlineManager().isOnline;\n\t};\n\tconst triggerRefetch = (event) => {\n\t\tif (!shouldRefetch()) return;\n\t\tif (event?.event === \"storage\") {\n\t\t\tstate.lastSync = now();\n\t\t\tsessionSignal.set(!sessionSignal.get());\n\t\t\treturn;\n\t\t}\n\t\tconst currentSession = sessionAtom.get();\n\t\tif (event?.event === \"poll\") {\n\t\t\tstate.lastSessionRequest = now();\n\t\t\t$fetch(\"/get-session\").then((res) => {\n\t\t\t\tif (res.error) sessionAtom.set({\n\t\t\t\t\t...currentSession,\n\t\t\t\t\tdata: null,\n\t\t\t\t\terror: res.error\n\t\t\t\t});\n\t\t\t\telse sessionAtom.set({\n\t\t\t\t\t...currentSession,\n\t\t\t\t\tdata: res.data,\n\t\t\t\t\terror: null\n\t\t\t\t});\n\t\t\t\tstate.lastSync = now();\n\t\t\t\tsessionSignal.set(!sessionSignal.get());\n\t\t\t}).catch(() => {});\n\t\t\treturn;\n\t\t}\n\t\tif (event?.event === \"visibilitychange\") {\n\t\t\tif (now() - state.lastSessionRequest < FOCUS_REFETCH_RATE_LIMIT_SECONDS) return;\n\t\t\tstate.lastSessionRequest = now();\n\t\t}\n\t\tif (currentSession?.data === null || currentSession?.data === void 0 || event?.event === \"visibilitychange\") {\n\t\t\tstate.lastSync = now();\n\t\t\tsessionSignal.set(!sessionSignal.get());\n\t\t}\n\t};\n\tconst broadcastSessionUpdate = (trigger) => {\n\t\tgetGlobalBroadcastChannel().post({\n\t\t\tevent: \"session\",\n\t\t\tdata: { trigger },\n\t\t\tclientId: Math.random().toString(36).substring(7)\n\t\t});\n\t};\n\tconst setupPolling = () => {\n\t\tif (refetchInterval && refetchInterval > 0) state.pollInterval = setInterval(() => {\n\t\t\tif (sessionAtom.get()?.data) triggerRefetch({ event: \"poll\" });\n\t\t}, refetchInterval * 1e3);\n\t};\n\tconst setupBroadcast = () => {\n\t\tstate.unsubscribeBroadcast = getGlobalBroadcastChannel().subscribe(() => {\n\t\t\ttriggerRefetch({ event: \"storage\" });\n\t\t});\n\t};\n\tconst setupFocusRefetch = () => {\n\t\tif (!refetchOnWindowFocus) return;\n\t\tstate.unsubscribeFocus = getGlobalFocusManager().subscribe(() => {\n\t\t\ttriggerRefetch({ event: \"visibilitychange\" });\n\t\t});\n\t};\n\tconst setupOnlineRefetch = () => {\n\t\tstate.unsubscribeOnline = getGlobalOnlineManager().subscribe((online) => {\n\t\t\tif (online) triggerRefetch({ event: \"visibilitychange\" });\n\t\t});\n\t};\n\tconst init = () => {\n\t\tsetupPolling();\n\t\tsetupBroadcast();\n\t\tsetupFocusRefetch();\n\t\tsetupOnlineRefetch();\n\t\tgetGlobalBroadcastChannel().setup();\n\t\tgetGlobalFocusManager().setup();\n\t\tgetGlobalOnlineManager().setup();\n\t};\n\tconst cleanup = () => {\n\t\tif (state.pollInterval) {\n\t\t\tclearInterval(state.pollInterval);\n\t\t\tstate.pollInterval = void 0;\n\t\t}\n\t\tif (state.unsubscribeBroadcast) {\n\t\t\tstate.unsubscribeBroadcast();\n\t\t\tstate.unsubscribeBroadcast = void 0;\n\t\t}\n\t\tif (state.unsubscribeFocus) {\n\t\t\tstate.unsubscribeFocus();\n\t\t\tstate.unsubscribeFocus = void 0;\n\t\t}\n\t\tif (state.unsubscribeOnline) {\n\t\t\tstate.unsubscribeOnline();\n\t\t\tstate.unsubscribeOnline = void 0;\n\t\t}\n\t\tstate.lastSync = 0;\n\t\tstate.lastSessionRequest = 0;\n\t\tstate.cachedSession = void 0;\n\t};\n\treturn {\n\t\tinit,\n\t\tcleanup,\n\t\ttriggerRefetch,\n\t\tbroadcastSessionUpdate\n\t};\n}\n\n//#endregion\nexport { createSessionRefreshManager };\n//# sourceMappingURL=session-refresh.mjs.map","import { useAuthQuery } from \"./query.mjs\";\nimport { createSessionRefreshManager } from \"./session-refresh.mjs\";\nimport { atom, onMount } from \"nanostores\";\n\n//#region src/client/session-atom.ts\nfunction getSessionAtom($fetch, options) {\n\tconst $signal = atom(false);\n\tconst session = useAuthQuery($signal, \"/get-session\", $fetch, { method: \"GET\" });\n\tonMount(session, () => {\n\t\tconst refreshManager = createSessionRefreshManager({\n\t\t\tsessionAtom: session,\n\t\t\tsessionSignal: $signal,\n\t\t\t$fetch,\n\t\t\toptions\n\t\t});\n\t\trefreshManager.init();\n\t\treturn () => {\n\t\t\trefreshManager.cleanup();\n\t\t};\n\t});\n\treturn {\n\t\tsession,\n\t\t$sessionSignal: $signal\n\t};\n}\n\n//#endregion\nexport { getSessionAtom };\n//# sourceMappingURL=session-atom.mjs.map","function isPlainObject(value) {\n  if (value === null || typeof value !== \"object\") {\n    return false;\n  }\n  const prototype = Object.getPrototypeOf(value);\n  if (prototype !== null && prototype !== Object.prototype && Object.getPrototypeOf(prototype) !== null) {\n    return false;\n  }\n  if (Symbol.iterator in value) {\n    return false;\n  }\n  if (Symbol.toStringTag in value) {\n    return Object.prototype.toString.call(value) === \"[object Module]\";\n  }\n  return true;\n}\n\nfunction _defu(baseObject, defaults, namespace = \".\", merger) {\n  if (!isPlainObject(defaults)) {\n    return _defu(baseObject, {}, namespace, merger);\n  }\n  const object = Object.assign({}, defaults);\n  for (const key in baseObject) {\n    if (key === \"__proto__\" || key === \"constructor\") {\n      continue;\n    }\n    const value = baseObject[key];\n    if (value === null || value === void 0) {\n      continue;\n    }\n    if (merger && merger(object, key, value, namespace)) {\n      continue;\n    }\n    if (Array.isArray(value) && Array.isArray(object[key])) {\n      object[key] = [...value, ...object[key]];\n    } else if (isPlainObject(value) && isPlainObject(object[key])) {\n      object[key] = _defu(\n        value,\n        object[key],\n        (namespace ? `${namespace}.` : \"\") + key.toString(),\n        merger\n      );\n    } else {\n      object[key] = value;\n    }\n  }\n  return object;\n}\nfunction createDefu(merger) {\n  return (...arguments_) => (\n    // eslint-disable-next-line unicorn/no-array-reduce\n    arguments_.reduce((p, c) => _defu(p, c, \"\", merger), {})\n  );\n}\nconst defu = createDefu();\nconst defuFn = createDefu((object, key, currentValue) => {\n  if (object[key] !== void 0 && typeof currentValue === \"function\") {\n    object[key] = currentValue(object[key]);\n    return true;\n  }\n});\nconst defuArrayFn = createDefu((object, key, currentValue) => {\n  if (Array.isArray(object[key]) && typeof currentValue === \"function\") {\n    object[key] = currentValue(object[key]);\n    return true;\n  }\n});\n\nexport { createDefu, defu as default, defu, defuArrayFn, defuFn };\n","var __defProp = Object.defineProperty;\nvar __defProps = Object.defineProperties;\nvar __getOwnPropDescs = Object.getOwnPropertyDescriptors;\nvar __getOwnPropSymbols = Object.getOwnPropertySymbols;\nvar __hasOwnProp = Object.prototype.hasOwnProperty;\nvar __propIsEnum = Object.prototype.propertyIsEnumerable;\nvar __defNormalProp = (obj, key, value) => key in obj ? __defProp(obj, key, { enumerable: true, configurable: true, writable: true, value }) : obj[key] = value;\nvar __spreadValues = (a, b) => {\n  for (var prop in b || (b = {}))\n    if (__hasOwnProp.call(b, prop))\n      __defNormalProp(a, prop, b[prop]);\n  if (__getOwnPropSymbols)\n    for (var prop of __getOwnPropSymbols(b)) {\n      if (__propIsEnum.call(b, prop))\n        __defNormalProp(a, prop, b[prop]);\n    }\n  return a;\n};\nvar __spreadProps = (a, b) => __defProps(a, __getOwnPropDescs(b));\n\n// src/error.ts\nvar BetterFetchError = class extends Error {\n  constructor(status, statusText, error) {\n    super(statusText || status.toString(), {\n      cause: error\n    });\n    this.status = status;\n    this.statusText = statusText;\n    this.error = error;\n    Error.captureStackTrace(this, this.constructor);\n  }\n};\n\n// src/plugins.ts\nvar initializePlugins = async (url, options) => {\n  var _a, _b, _c, _d, _e, _f;\n  let opts = options || {};\n  const hooks = {\n    onRequest: [options == null ? void 0 : options.onRequest],\n    onResponse: [options == null ? void 0 : options.onResponse],\n    onSuccess: [options == null ? void 0 : options.onSuccess],\n    onError: [options == null ? void 0 : options.onError],\n    onRetry: [options == null ? void 0 : options.onRetry]\n  };\n  if (!options || !(options == null ? void 0 : options.plugins)) {\n    return {\n      url,\n      options: opts,\n      hooks\n    };\n  }\n  for (const plugin of (options == null ? void 0 : options.plugins) || []) {\n    if (plugin.init) {\n      const pluginRes = await ((_a = plugin.init) == null ? void 0 : _a.call(plugin, url.toString(), options));\n      opts = pluginRes.options || opts;\n      url = pluginRes.url;\n    }\n    hooks.onRequest.push((_b = plugin.hooks) == null ? void 0 : _b.onRequest);\n    hooks.onResponse.push((_c = plugin.hooks) == null ? void 0 : _c.onResponse);\n    hooks.onSuccess.push((_d = plugin.hooks) == null ? void 0 : _d.onSuccess);\n    hooks.onError.push((_e = plugin.hooks) == null ? void 0 : _e.onError);\n    hooks.onRetry.push((_f = plugin.hooks) == null ? void 0 : _f.onRetry);\n  }\n  return {\n    url,\n    options: opts,\n    hooks\n  };\n};\n\n// src/retry.ts\nvar LinearRetryStrategy = class {\n  constructor(options) {\n    this.options = options;\n  }\n  shouldAttemptRetry(attempt, response) {\n    if (this.options.shouldRetry) {\n      return Promise.resolve(\n        attempt < this.options.attempts && this.options.shouldRetry(response)\n      );\n    }\n    return Promise.resolve(attempt < this.options.attempts);\n  }\n  getDelay() {\n    return this.options.delay;\n  }\n};\nvar ExponentialRetryStrategy = class {\n  constructor(options) {\n    this.options = options;\n  }\n  shouldAttemptRetry(attempt, response) {\n    if (this.options.shouldRetry) {\n      return Promise.resolve(\n        attempt < this.options.attempts && this.options.shouldRetry(response)\n      );\n    }\n    return Promise.resolve(attempt < this.options.attempts);\n  }\n  getDelay(attempt) {\n    const delay = Math.min(\n      this.options.maxDelay,\n      this.options.baseDelay * 2 ** attempt\n    );\n    return delay;\n  }\n};\nfunction createRetryStrategy(options) {\n  if (typeof options === \"number\") {\n    return new LinearRetryStrategy({\n      type: \"linear\",\n      attempts: options,\n      delay: 1e3\n    });\n  }\n  switch (options.type) {\n    case \"linear\":\n      return new LinearRetryStrategy(options);\n    case \"exponential\":\n      return new ExponentialRetryStrategy(options);\n    default:\n      throw new Error(\"Invalid retry strategy\");\n  }\n}\n\n// src/auth.ts\nvar getAuthHeader = async (options) => {\n  const headers = {};\n  const getValue = async (value) => typeof value === \"function\" ? await value() : value;\n  if (options == null ? void 0 : options.auth) {\n    if (options.auth.type === \"Bearer\") {\n      const token = await getValue(options.auth.token);\n      if (!token) {\n        return headers;\n      }\n      headers[\"authorization\"] = `Bearer ${token}`;\n    } else if (options.auth.type === \"Basic\") {\n      const [username, password] = await Promise.all([\n        getValue(options.auth.username),\n        getValue(options.auth.password)\n      ]);\n      if (!username || !password) {\n        return headers;\n      }\n      headers[\"authorization\"] = `Basic ${btoa(`${username}:${password}`)}`;\n    } else if (options.auth.type === \"Custom\") {\n      const [prefix, value] = await Promise.all([\n        getValue(options.auth.prefix),\n        getValue(options.auth.value)\n      ]);\n      if (!value) {\n        return headers;\n      }\n      headers[\"authorization\"] = `${prefix != null ? prefix : \"\"} ${value}`;\n    }\n  }\n  return headers;\n};\n\n// src/utils.ts\nvar JSON_RE = /^application\\/(?:[\\w!#$%&*.^`~-]*\\+)?json(;.+)?$/i;\nfunction detectResponseType(request) {\n  const _contentType = request.headers.get(\"content-type\");\n  const textTypes = /* @__PURE__ */ new Set([\n    \"image/svg\",\n    \"application/xml\",\n    \"application/xhtml\",\n    \"application/html\"\n  ]);\n  if (!_contentType) {\n    return \"json\";\n  }\n  const contentType = _contentType.split(\";\").shift() || \"\";\n  if (JSON_RE.test(contentType)) {\n    return \"json\";\n  }\n  if (textTypes.has(contentType) || contentType.startsWith(\"text/\")) {\n    return \"text\";\n  }\n  return \"blob\";\n}\nfunction isJSONParsable(value) {\n  try {\n    JSON.parse(value);\n    return true;\n  } catch (error) {\n    return false;\n  }\n}\nfunction isJSONSerializable(value) {\n  if (value === void 0) {\n    return false;\n  }\n  const t = typeof value;\n  if (t === \"string\" || t === \"number\" || t === \"boolean\" || t === null) {\n    return true;\n  }\n  if (t !== \"object\") {\n    return false;\n  }\n  if (Array.isArray(value)) {\n    return true;\n  }\n  if (value.buffer) {\n    return false;\n  }\n  return value.constructor && value.constructor.name === \"Object\" || typeof value.toJSON === \"function\";\n}\nfunction jsonParse(text) {\n  try {\n    return JSON.parse(text);\n  } catch (error) {\n    return text;\n  }\n}\nfunction isFunction(value) {\n  return typeof value === \"function\";\n}\nfunction getFetch(options) {\n  if (options == null ? void 0 : options.customFetchImpl) {\n    return options.customFetchImpl;\n  }\n  if (typeof globalThis !== \"undefined\" && isFunction(globalThis.fetch)) {\n    return globalThis.fetch;\n  }\n  if (typeof window !== \"undefined\" && isFunction(window.fetch)) {\n    return window.fetch;\n  }\n  throw new Error(\"No fetch implementation found\");\n}\nfunction isPayloadMethod(method) {\n  if (!method) {\n    return false;\n  }\n  const payloadMethod = [\"POST\", \"PUT\", \"PATCH\", \"DELETE\"];\n  return payloadMethod.includes(method.toUpperCase());\n}\nfunction isRouteMethod(method) {\n  const routeMethod = [\"GET\", \"POST\", \"PUT\", \"PATCH\", \"DELETE\"];\n  if (!method) {\n    return false;\n  }\n  return routeMethod.includes(method.toUpperCase());\n}\nasync function getHeaders(opts) {\n  const headers = new Headers(opts == null ? void 0 : opts.headers);\n  const authHeader = await getAuthHeader(opts);\n  for (const [key, value] of Object.entries(authHeader || {})) {\n    headers.set(key, value);\n  }\n  if (!headers.has(\"content-type\")) {\n    const t = detectContentType(opts == null ? void 0 : opts.body);\n    if (t) {\n      headers.set(\"content-type\", t);\n    }\n  }\n  return headers;\n}\nfunction getURL(url, options) {\n  if (url.startsWith(\"@\")) {\n    const m = url.toString().split(\"@\")[1].split(\"/\")[0];\n    if (methods.includes(m)) {\n      url = url.replace(`@${m}/`, \"/\");\n    }\n  }\n  let _url;\n  try {\n    if (url.startsWith(\"http\")) {\n      _url = url;\n    } else {\n      let baseURL = options == null ? void 0 : options.baseURL;\n      if (baseURL && !(baseURL == null ? void 0 : baseURL.endsWith(\"/\"))) {\n        baseURL = baseURL + \"/\";\n      }\n      if (url.startsWith(\"/\")) {\n        _url = new URL(url.substring(1), baseURL);\n      } else {\n        _url = new URL(url, options == null ? void 0 : options.baseURL);\n      }\n    }\n  } catch (e) {\n    if (e instanceof TypeError) {\n      if (!(options == null ? void 0 : options.baseURL)) {\n        throw TypeError(\n          `Invalid URL ${url}. Are you passing in a relative url but not setting the baseURL?`\n        );\n      }\n      throw TypeError(\n        `Invalid URL ${url}. Please validate that you are passing the correct input.`\n      );\n    }\n    throw e;\n  }\n  if (options == null ? void 0 : options.params) {\n    if (Array.isArray(options == null ? void 0 : options.params)) {\n      const params = (options == null ? void 0 : options.params) ? Array.isArray(options.params) ? `/${options.params.join(\"/\")}` : `/${Object.values(options.params).join(\"/\")}` : \"\";\n      _url = _url.toString().split(\"/:\")[0];\n      _url = `${_url.toString()}${params}`;\n    } else {\n      for (const [key, value] of Object.entries(options == null ? void 0 : options.params)) {\n        _url = _url.toString().replace(`:${key}`, String(value));\n      }\n    }\n  }\n  const __url = new URL(_url);\n  const queryParams = options == null ? void 0 : options.query;\n  if (queryParams) {\n    for (const [key, value] of Object.entries(queryParams)) {\n      __url.searchParams.append(key, String(value));\n    }\n  }\n  return __url;\n}\nfunction detectContentType(body) {\n  if (isJSONSerializable(body)) {\n    return \"application/json\";\n  }\n  return null;\n}\nfunction getBody(options) {\n  if (!(options == null ? void 0 : options.body)) {\n    return null;\n  }\n  const headers = new Headers(options == null ? void 0 : options.headers);\n  if (isJSONSerializable(options.body) && !headers.has(\"content-type\")) {\n    for (const [key, value] of Object.entries(options == null ? void 0 : options.body)) {\n      if (value instanceof Date) {\n        options.body[key] = value.toISOString();\n      }\n    }\n    return JSON.stringify(options.body);\n  }\n  if (headers.has(\"content-type\") && headers.get(\"content-type\") === \"application/x-www-form-urlencoded\") {\n    if (isJSONSerializable(options.body)) {\n      return new URLSearchParams(options.body).toString();\n    }\n    return options.body;\n  }\n  return options.body;\n}\nfunction getMethod(url, options) {\n  var _a;\n  if (options == null ? void 0 : options.method) {\n    return options.method.toUpperCase();\n  }\n  if (url.startsWith(\"@\")) {\n    const pMethod = (_a = url.split(\"@\")[1]) == null ? void 0 : _a.split(\"/\")[0];\n    if (!methods.includes(pMethod)) {\n      return (options == null ? void 0 : options.body) ? \"POST\" : \"GET\";\n    }\n    return pMethod.toUpperCase();\n  }\n  return (options == null ? void 0 : options.body) ? \"POST\" : \"GET\";\n}\nfunction getTimeout(options, controller) {\n  let abortTimeout;\n  if (!(options == null ? void 0 : options.signal) && (options == null ? void 0 : options.timeout)) {\n    abortTimeout = setTimeout(() => controller == null ? void 0 : controller.abort(), options == null ? void 0 : options.timeout);\n  }\n  return {\n    abortTimeout,\n    clearTimeout: () => {\n      if (abortTimeout) {\n        clearTimeout(abortTimeout);\n      }\n    }\n  };\n}\nfunction bodyParser(data, responseType) {\n  if (responseType === \"json\") {\n    return JSON.parse(data);\n  }\n  return data;\n}\nvar ValidationError = class _ValidationError extends Error {\n  constructor(issues, message) {\n    super(message || JSON.stringify(issues, null, 2));\n    this.issues = issues;\n    Object.setPrototypeOf(this, _ValidationError.prototype);\n  }\n};\nasync function parseStandardSchema(schema, input) {\n  const result = await schema[\"~standard\"].validate(input);\n  if (result.issues) {\n    throw new ValidationError(result.issues);\n  }\n  return result.value;\n}\n\n// src/create-fetch/schema.ts\nvar methods = [\"get\", \"post\", \"put\", \"patch\", \"delete\"];\nvar createSchema = (schema, config) => {\n  return {\n    schema,\n    config\n  };\n};\n\n// src/create-fetch/index.ts\nvar applySchemaPlugin = (config) => ({\n  id: \"apply-schema\",\n  name: \"Apply Schema\",\n  version: \"1.0.0\",\n  async init(url, options) {\n    var _a, _b, _c, _d;\n    const schema = ((_b = (_a = config.plugins) == null ? void 0 : _a.find(\n      (plugin) => {\n        var _a2;\n        return ((_a2 = plugin.schema) == null ? void 0 : _a2.config) ? url.startsWith(plugin.schema.config.baseURL || \"\") || url.startsWith(plugin.schema.config.prefix || \"\") : false;\n      }\n    )) == null ? void 0 : _b.schema) || config.schema;\n    if (schema) {\n      let urlKey = url;\n      if ((_c = schema.config) == null ? void 0 : _c.prefix) {\n        if (urlKey.startsWith(schema.config.prefix)) {\n          urlKey = urlKey.replace(schema.config.prefix, \"\");\n          if (schema.config.baseURL) {\n            url = url.replace(schema.config.prefix, schema.config.baseURL);\n          }\n        }\n      }\n      if ((_d = schema.config) == null ? void 0 : _d.baseURL) {\n        if (urlKey.startsWith(schema.config.baseURL)) {\n          urlKey = urlKey.replace(schema.config.baseURL, \"\");\n        }\n      }\n      const keySchema = schema.schema[urlKey];\n      if (keySchema) {\n        let opts = __spreadProps(__spreadValues({}, options), {\n          method: keySchema.method,\n          output: keySchema.output\n        });\n        if (!(options == null ? void 0 : options.disableValidation)) {\n          opts = __spreadProps(__spreadValues({}, opts), {\n            body: keySchema.input ? await parseStandardSchema(keySchema.input, options == null ? void 0 : options.body) : options == null ? void 0 : options.body,\n            params: keySchema.params ? await parseStandardSchema(keySchema.params, options == null ? void 0 : options.params) : options == null ? void 0 : options.params,\n            query: keySchema.query ? await parseStandardSchema(keySchema.query, options == null ? void 0 : options.query) : options == null ? void 0 : options.query\n          });\n        }\n        return {\n          url,\n          options: opts\n        };\n      }\n    }\n    return {\n      url,\n      options\n    };\n  }\n});\nvar createFetch = (config) => {\n  async function $fetch(url, options) {\n    const opts = __spreadProps(__spreadValues(__spreadValues({}, config), options), {\n      plugins: [...(config == null ? void 0 : config.plugins) || [], applySchemaPlugin(config || {}), ...(options == null ? void 0 : options.plugins) || []]\n    });\n    if (config == null ? void 0 : config.catchAllError) {\n      try {\n        return await betterFetch(url, opts);\n      } catch (error) {\n        return {\n          data: null,\n          error: {\n            status: 500,\n            statusText: \"Fetch Error\",\n            message: \"Fetch related error. Captured by catchAllError option. See error property for more details.\",\n            error\n          }\n        };\n      }\n    }\n    return await betterFetch(url, opts);\n  }\n  return $fetch;\n};\n\n// src/url.ts\nfunction getURL2(url, option) {\n  const { baseURL, params, query } = option || {\n    query: {},\n    params: {},\n    baseURL: \"\"\n  };\n  let basePath = url.startsWith(\"http\") ? url.split(\"/\").slice(0, 3).join(\"/\") : baseURL || \"\";\n  if (url.startsWith(\"@\")) {\n    const m = url.toString().split(\"@\")[1].split(\"/\")[0];\n    if (methods.includes(m)) {\n      url = url.replace(`@${m}/`, \"/\");\n    }\n  }\n  if (!basePath.endsWith(\"/\")) basePath += \"/\";\n  let [path, urlQuery] = url.replace(basePath, \"\").split(\"?\");\n  const queryParams = new URLSearchParams(urlQuery);\n  for (const [key, value] of Object.entries(query || {})) {\n    if (value == null) continue;\n    let serializedValue;\n    if (typeof value === \"string\") {\n      serializedValue = value;\n    } else if (Array.isArray(value)) {\n      for (const val of value) {\n        queryParams.append(key, val);\n      }\n      continue;\n    } else {\n      serializedValue = JSON.stringify(value);\n    }\n    queryParams.set(key, serializedValue);\n  }\n  if (params) {\n    if (Array.isArray(params)) {\n      const paramPaths = path.split(\"/\").filter((p) => p.startsWith(\":\"));\n      for (const [index, key] of paramPaths.entries()) {\n        const value = params[index];\n        path = path.replace(key, value);\n      }\n    } else {\n      for (const [key, value] of Object.entries(params)) {\n        path = path.replace(`:${key}`, String(value));\n      }\n    }\n  }\n  path = path.split(\"/\").map(encodeURIComponent).join(\"/\");\n  if (path.startsWith(\"/\")) path = path.slice(1);\n  let queryParamString = queryParams.toString();\n  queryParamString = queryParamString.length > 0 ? `?${queryParamString}`.replace(/\\+/g, \"%20\") : \"\";\n  if (!basePath.startsWith(\"http\")) {\n    return `${basePath}${path}${queryParamString}`;\n  }\n  const _url = new URL(`${path}${queryParamString}`, basePath);\n  return _url;\n}\n\n// src/fetch.ts\nvar betterFetch = async (url, options) => {\n  var _a, _b, _c, _d, _e, _f, _g, _h;\n  const {\n    hooks,\n    url: __url,\n    options: opts\n  } = await initializePlugins(url, options);\n  const fetch = getFetch(opts);\n  const controller = new AbortController();\n  const signal = (_a = opts.signal) != null ? _a : controller.signal;\n  const _url = getURL2(__url, opts);\n  const body = getBody(opts);\n  const headers = await getHeaders(opts);\n  const method = getMethod(__url, opts);\n  let context = __spreadProps(__spreadValues({}, opts), {\n    url: _url,\n    headers,\n    body,\n    method,\n    signal\n  });\n  for (const onRequest of hooks.onRequest) {\n    if (onRequest) {\n      const res = await onRequest(context);\n      if (typeof res === \"object\" && res !== null) {\n        context = res;\n      }\n    }\n  }\n  if (\"pipeTo\" in context && typeof context.pipeTo === \"function\" || typeof ((_b = options == null ? void 0 : options.body) == null ? void 0 : _b.pipe) === \"function\") {\n    if (!(\"duplex\" in context)) {\n      context.duplex = \"half\";\n    }\n  }\n  const { clearTimeout: clearTimeout2 } = getTimeout(opts, controller);\n  let response = await fetch(context.url, context);\n  clearTimeout2();\n  const responseContext = {\n    response,\n    request: context\n  };\n  for (const onResponse of hooks.onResponse) {\n    if (onResponse) {\n      const r = await onResponse(__spreadProps(__spreadValues({}, responseContext), {\n        response: ((_c = options == null ? void 0 : options.hookOptions) == null ? void 0 : _c.cloneResponse) ? response.clone() : response\n      }));\n      if (r instanceof Response) {\n        response = r;\n      } else if (typeof r === \"object\" && r !== null) {\n        response = r.response;\n      }\n    }\n  }\n  if (response.ok) {\n    const hasBody = context.method !== \"HEAD\";\n    if (!hasBody) {\n      return {\n        data: \"\",\n        error: null\n      };\n    }\n    const responseType = detectResponseType(response);\n    const successContext = {\n      data: null,\n      response,\n      request: context\n    };\n    if (responseType === \"json\" || responseType === \"text\") {\n      const text = await response.text();\n      const parser2 = (_d = context.jsonParser) != null ? _d : jsonParse;\n      successContext.data = await parser2(text);\n    } else {\n      successContext.data = await response[responseType]();\n    }\n    if (context == null ? void 0 : context.output) {\n      if (context.output && !context.disableValidation) {\n        successContext.data = await parseStandardSchema(\n          context.output,\n          successContext.data\n        );\n      }\n    }\n    for (const onSuccess of hooks.onSuccess) {\n      if (onSuccess) {\n        await onSuccess(__spreadProps(__spreadValues({}, successContext), {\n          response: ((_e = options == null ? void 0 : options.hookOptions) == null ? void 0 : _e.cloneResponse) ? response.clone() : response\n        }));\n      }\n    }\n    if (options == null ? void 0 : options.throw) {\n      return successContext.data;\n    }\n    return {\n      data: successContext.data,\n      error: null\n    };\n  }\n  const parser = (_f = options == null ? void 0 : options.jsonParser) != null ? _f : jsonParse;\n  const responseText = await response.text();\n  const isJSONResponse = isJSONParsable(responseText);\n  const errorObject = isJSONResponse ? await parser(responseText) : null;\n  const errorContext = {\n    response,\n    responseText,\n    request: context,\n    error: __spreadProps(__spreadValues({}, errorObject), {\n      status: response.status,\n      statusText: response.statusText\n    })\n  };\n  for (const onError of hooks.onError) {\n    if (onError) {\n      await onError(__spreadProps(__spreadValues({}, errorContext), {\n        response: ((_g = options == null ? void 0 : options.hookOptions) == null ? void 0 : _g.cloneResponse) ? response.clone() : response\n      }));\n    }\n  }\n  if (options == null ? void 0 : options.retry) {\n    const retryStrategy = createRetryStrategy(options.retry);\n    const _retryAttempt = (_h = options.retryAttempt) != null ? _h : 0;\n    if (await retryStrategy.shouldAttemptRetry(_retryAttempt, response)) {\n      for (const onRetry of hooks.onRetry) {\n        if (onRetry) {\n          await onRetry(responseContext);\n        }\n      }\n      const delay = retryStrategy.getDelay(_retryAttempt);\n      await new Promise((resolve) => setTimeout(resolve, delay));\n      return await betterFetch(url, __spreadProps(__spreadValues({}, options), {\n        retryAttempt: _retryAttempt + 1\n      }));\n    }\n  }\n  if (options == null ? void 0 : options.throw) {\n    throw new BetterFetchError(\n      response.status,\n      response.statusText,\n      isJSONResponse ? errorObject : responseText\n    );\n  }\n  return {\n    data: null,\n    error: __spreadProps(__spreadValues({}, errorObject), {\n      status: response.status,\n      statusText: response.statusText\n    })\n  };\n};\nexport {\n  BetterFetchError,\n  ValidationError,\n  applySchemaPlugin,\n  betterFetch,\n  bodyParser,\n  createFetch,\n  createRetryStrategy,\n  createSchema,\n  detectContentType,\n  detectResponseType,\n  getBody,\n  getFetch,\n  getHeaders,\n  getMethod,\n  getTimeout,\n  getURL,\n  initializePlugins,\n  isFunction,\n  isJSONParsable,\n  isJSONSerializable,\n  isPayloadMethod,\n  isRouteMethod,\n  jsonParse,\n  methods,\n  parseStandardSchema\n};\n//# sourceMappingURL=index.js.map","import { getBaseURL } from \"../utils/url.mjs\";\nimport { redirectPlugin } from \"./fetch-plugins.mjs\";\nimport { parseJSON } from \"./parser.mjs\";\nimport { getSessionAtom } from \"./session-atom.mjs\";\nimport { defu as defu$1 } from \"defu\";\nimport { createFetch } from \"@better-fetch/fetch\";\n\n//#region src/client/config.ts\nconst getClientConfig = (options, loadEnv) => {\n\tconst isCredentialsSupported = \"credentials\" in Request.prototype;\n\tconst baseURL = getBaseURL(options?.baseURL, options?.basePath, void 0, loadEnv) ?? \"/api/auth\";\n\tconst pluginsFetchPlugins = options?.plugins?.flatMap((plugin) => plugin.fetchPlugins).filter((pl) => pl !== void 0) || [];\n\tconst lifeCyclePlugin = {\n\t\tid: \"lifecycle-hooks\",\n\t\tname: \"lifecycle-hooks\",\n\t\thooks: {\n\t\t\tonSuccess: options?.fetchOptions?.onSuccess,\n\t\t\tonError: options?.fetchOptions?.onError,\n\t\t\tonRequest: options?.fetchOptions?.onRequest,\n\t\t\tonResponse: options?.fetchOptions?.onResponse\n\t\t}\n\t};\n\tconst { onSuccess: _onSuccess, onError: _onError, onRequest: _onRequest, onResponse: _onResponse, ...restOfFetchOptions } = options?.fetchOptions || {};\n\tconst $fetch = createFetch({\n\t\tbaseURL,\n\t\t...isCredentialsSupported ? { credentials: \"include\" } : {},\n\t\tmethod: \"GET\",\n\t\tjsonParser(text) {\n\t\t\tif (!text) return null;\n\t\t\treturn parseJSON(text, { strict: false });\n\t\t},\n\t\tcustomFetchImpl: fetch,\n\t\t...restOfFetchOptions,\n\t\tplugins: [\n\t\t\tlifeCyclePlugin,\n\t\t\t...restOfFetchOptions.plugins || [],\n\t\t\t...options?.disableDefaultFetchPlugins ? [] : [redirectPlugin],\n\t\t\t...pluginsFetchPlugins\n\t\t]\n\t});\n\tconst { $sessionSignal, session } = getSessionAtom($fetch, options);\n\tconst plugins = options?.plugins || [];\n\tlet pluginsActions = {};\n\tconst pluginsAtoms = {\n\t\t$sessionSignal,\n\t\tsession\n\t};\n\tconst pluginPathMethods = {\n\t\t\"/sign-out\": \"POST\",\n\t\t\"/revoke-sessions\": \"POST\",\n\t\t\"/revoke-other-sessions\": \"POST\",\n\t\t\"/delete-user\": \"POST\"\n\t};\n\tconst atomListeners = [{\n\t\tsignal: \"$sessionSignal\",\n\t\tmatcher(path) {\n\t\t\treturn path === \"/sign-out\" || path === \"/update-user\" || path === \"/sign-up/email\" || path === \"/sign-in/email\" || path === \"/delete-user\" || path === \"/verify-email\" || path === \"/revoke-sessions\" || path === \"/revoke-session\" || path === \"/change-email\";\n\t\t}\n\t}];\n\tfor (const plugin of plugins) {\n\t\tif (plugin.getAtoms) Object.assign(pluginsAtoms, plugin.getAtoms?.($fetch));\n\t\tif (plugin.pathMethods) Object.assign(pluginPathMethods, plugin.pathMethods);\n\t\tif (plugin.atomListeners) atomListeners.push(...plugin.atomListeners);\n\t}\n\tconst $store = {\n\t\tnotify: (signal) => {\n\t\t\tpluginsAtoms[signal].set(!pluginsAtoms[signal].get());\n\t\t},\n\t\tlisten: (signal, listener) => {\n\t\t\tpluginsAtoms[signal].subscribe(listener);\n\t\t},\n\t\tatoms: pluginsAtoms\n\t};\n\tfor (const plugin of plugins) if (plugin.getActions) pluginsActions = defu$1(plugin.getActions?.($fetch, $store, options) ?? {}, pluginsActions);\n\treturn {\n\t\tget baseURL() {\n\t\t\treturn baseURL;\n\t\t},\n\t\tpluginsActions,\n\t\tpluginsAtoms,\n\t\tpluginPathMethods,\n\t\tatomListeners,\n\t\t$fetch,\n\t\t$store\n\t};\n};\n\n//#endregion\nexport { getClientConfig };\n//# sourceMappingURL=config.mjs.map","//#region src/utils/is-atom.ts\nfunction isAtom(value) {\n\treturn typeof value === \"object\" && value !== null && \"get\" in value && typeof value.get === \"function\" && \"lc\" in value && typeof value.lc === \"number\";\n}\n\n//#endregion\nexport { isAtom };\n//# sourceMappingURL=is-atom.mjs.map","import { isAtom } from \"../utils/is-atom.mjs\";\n\n//#region src/client/proxy.ts\nfunction getMethod(path, knownPathMethods, args) {\n\tconst method = knownPathMethods[path];\n\tconst { fetchOptions, query: _query, ...body } = args || {};\n\tif (method) return method;\n\tif (fetchOptions?.method) return fetchOptions.method;\n\tif (body && Object.keys(body).length > 0) return \"POST\";\n\treturn \"GET\";\n}\nfunction createDynamicPathProxy(routes, client, knownPathMethods, atoms, atomListeners) {\n\tfunction createProxy(path = []) {\n\t\treturn new Proxy(function() {}, {\n\t\t\tget(_, prop) {\n\t\t\t\tif (typeof prop !== \"string\") return;\n\t\t\t\tif (prop === \"then\" || prop === \"catch\" || prop === \"finally\") return;\n\t\t\t\tconst fullPath = [...path, prop];\n\t\t\t\tlet current = routes;\n\t\t\t\tfor (const segment of fullPath) if (current && typeof current === \"object\" && segment in current) current = current[segment];\n\t\t\t\telse {\n\t\t\t\t\tcurrent = void 0;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\tif (typeof current === \"function\") return current;\n\t\t\t\tif (isAtom(current)) return current;\n\t\t\t\treturn createProxy(fullPath);\n\t\t\t},\n\t\t\tapply: async (_, __, args) => {\n\t\t\t\tconst routePath = \"/\" + path.map((segment) => segment.replace(/[A-Z]/g, (letter) => `-${letter.toLowerCase()}`)).join(\"/\");\n\t\t\t\tconst arg = args[0] || {};\n\t\t\t\tconst fetchOptions = args[1] || {};\n\t\t\t\tconst { query, fetchOptions: argFetchOptions, ...body } = arg;\n\t\t\t\tconst options = {\n\t\t\t\t\t...fetchOptions,\n\t\t\t\t\t...argFetchOptions\n\t\t\t\t};\n\t\t\t\tconst method = getMethod(routePath, knownPathMethods, arg);\n\t\t\t\treturn await client(routePath, {\n\t\t\t\t\t...options,\n\t\t\t\t\tbody: method === \"GET\" ? void 0 : {\n\t\t\t\t\t\t...body,\n\t\t\t\t\t\t...options?.body || {}\n\t\t\t\t\t},\n\t\t\t\t\tquery: query || options?.query,\n\t\t\t\t\tmethod,\n\t\t\t\t\tasync onSuccess(context) {\n\t\t\t\t\t\tawait options?.onSuccess?.(context);\n\t\t\t\t\t\tif (!atomListeners || options.disableSignal) return;\n\t\t\t\t\t\t/**\n\t\t\t\t\t\t* We trigger listeners\n\t\t\t\t\t\t*/\n\t\t\t\t\t\tconst matches = atomListeners.filter((s) => s.matcher(routePath));\n\t\t\t\t\t\tif (!matches.length) return;\n\t\t\t\t\t\tconst visited = /* @__PURE__ */ new Set();\n\t\t\t\t\t\tfor (const match of matches) {\n\t\t\t\t\t\t\tconst signal = atoms[match.signal];\n\t\t\t\t\t\t\tif (!signal) return;\n\t\t\t\t\t\t\tif (visited.has(match.signal)) continue;\n\t\t\t\t\t\t\tvisited.add(match.signal);\n\t\t\t\t\t\t\t/**\n\t\t\t\t\t\t\t* To avoid race conditions we set the signal in a setTimeout\n\t\t\t\t\t\t\t*/\n\t\t\t\t\t\t\tconst val = signal.get();\n\t\t\t\t\t\t\tsetTimeout(() => {\n\t\t\t\t\t\t\t\tsignal.set(!val);\n\t\t\t\t\t\t\t}, 10);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t});\n\t}\n\treturn createProxy();\n}\n\n//#endregion\nexport { createDynamicPathProxy };\n//# sourceMappingURL=proxy.mjs.map","import { listenKeys } from \"nanostores\";\nimport { useCallback, useRef, useSyncExternalStore } from \"react\";\n\n//#region src/client/react/react-store.ts\n/**\n* Subscribe to store changes and get store's value.\n*\n* Can be used with store builder too.\n*\n* ```js\n* import { useStore } from 'nanostores/react'\n*\n* import { router } from '../store/router'\n*\n* export const Layout = () => {\n*   let page = useStore(router)\n*   if (page.route === 'home') {\n*     return <HomePage />\n*   } else {\n*     return <Error404 />\n*   }\n* }\n* ```\n*\n* @param store Store instance.\n* @returns Store value.\n*/\nfunction useStore(store, options = {}) {\n\tconst snapshotRef = useRef(store.get());\n\tconst { keys, deps = [store, keys] } = options;\n\tconst subscribe = useCallback((onChange) => {\n\t\tconst emitChange = (value) => {\n\t\t\tif (snapshotRef.current === value) return;\n\t\t\tsnapshotRef.current = value;\n\t\t\tonChange();\n\t\t};\n\t\temitChange(store.value);\n\t\tif (keys?.length) return listenKeys(store, keys, emitChange);\n\t\treturn store.listen(emitChange);\n\t}, deps);\n\tconst get = () => snapshotRef.current;\n\treturn useSyncExternalStore(subscribe, get, get);\n}\n\n//#endregion\nexport { useStore };\n//# sourceMappingURL=react-store.mjs.map","import { getClientConfig } from \"../config.mjs\";\nimport { createDynamicPathProxy } from \"../proxy.mjs\";\nimport { useStore } from \"./react-store.mjs\";\nimport { capitalizeFirstLetter } from \"@better-auth/core/utils\";\n\n//#region src/client/react/index.ts\nfunction getAtomKey(str) {\n\treturn `use${capitalizeFirstLetter(str)}`;\n}\nfunction createAuthClient(options) {\n\tconst { pluginPathMethods, pluginsActions, pluginsAtoms, $fetch, $store, atomListeners } = getClientConfig(options);\n\tconst resolvedHooks = {};\n\tfor (const [key, value] of Object.entries(pluginsAtoms)) resolvedHooks[getAtomKey(key)] = () => useStore(value);\n\treturn createDynamicPathProxy({\n\t\t...pluginsActions,\n\t\t...resolvedHooks,\n\t\t$fetch,\n\t\t$store\n\t}, $fetch, pluginPathMethods, pluginsAtoms, atomListeners);\n}\n\n//#endregion\nexport { createAuthClient, useStore };\n//# sourceMappingURL=index.mjs.map"],"mappings":"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"}