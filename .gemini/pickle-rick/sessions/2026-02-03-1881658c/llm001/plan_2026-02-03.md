# LLM Integration Implementation Plan

## Overview
Securely integrate LLM-based complex news analysis into the AugmentedRLAgent pipeline using a structured, measured Gateway.

## Current State Analysis
- `src/ml/reinforcement_learning/augmented_agent.py`: `analyze_complex_news` is unimplemented.
- `src/services/llm_gateway.py`: Newly created framework for structured I/O and safety.

## Phase 1: Gateway Hardening
### Overview
Add actual httpx integration to the Gateway and refine the safety filters.
### Changes Required:
#### 1. src/services/llm_gateway.py
**Changes**: Add `httpx` POST logic to communicate with an LLM provider (using env-based API keys).

## Phase 2: Agent Augmentation
### Overview
Connect the `AugmentedRLAgent` to the `LLMGateway`.
### Changes Required:
#### 1. src/ml/reinforcement_learning/augmented_agent.py
**Changes**: Initialize `LLMGateway` in the constructor. Implement `analyze_complex_news` using the gateway.
#### 2. src/ml/reinforcement_learning/augmented_agent.py
**Changes**: Update `get_augmented_observation` to include the sentiment/confidence scores from the LLM.

## Phase 3: Telemetry
### Overview
Expose LLM performance metrics to the system's Prometheus registry.
### Changes Required:
#### 1. src/shared/observability.py
**Changes**: Add new metrics: `LLM_LATENCY`, `LLM_TOKEN_USAGE`, `LLM_SAFETY_VIOLATIONS`.
